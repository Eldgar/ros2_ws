# ~/ros2_ws/src/tortoisebot_ros2_docker/docker-compose.yml

version: "3.7"

services:
  gazebo:
    container_name: tortoisebot-ros2-gazebo
    image: eldgar/tortoisebot-ros2-docker-gazebo:updated
    command: >
      bash -c "source /opt/ros/galactic/setup.bash &&
               source install/setup.bash &&
               ros2 launch tortoisebot_gazebo gazebo.launch.py use_sim_time:=True"
    # Set up X11 for GUI
    environment:
      - DISPLAY=:1
      - QT_X11_NO_MITSHM=1
    volumes:
      - /tmp/.X11-unix:/tmp/.X11-unix:rw

  slam:
    container_name: tortoisebot-ros2-slam
    image: eldgar/tortoisebot-ros2-docker-slam:updated
    depends_on:
      - gazebo
    command: >
      bash -c "source /opt/ros/galactic/setup.bash &&
               source install/setup.bash &&
               ros2 launch tortoisebot_bringup mapping.launch.py use_sim_time:=True"
    environment:
      - DISPLAY=:2
      - QT_X11_NO_MITSHM=1
    volumes:
      - /tmp/.X11-unix:/tmp/.X11-unix:rw